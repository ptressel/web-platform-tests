<!DOCTYPE html>
<meta charset=utf-8>
<title>Blob slice</title>
<link rel=help href="http://dev.w3.org/2006/webapi/FileAPI/#slice-method-algo">
<link rel=author title="Saurabh Anand" href="mailto:saurabhanandiit@gmail.com">
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="support/Blob.js"></script>
<div id="log"></div>
<script>
test_blob(function() {
  var blobTemp = new Blob(["PASS"]);
  return blobTemp.slice();
}, {
  expected: "PASS",
  type: "",
  desc: "no-argument Blob slice"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(-6);
}, {
  expected: "STRING",
  type: "",
  desc: "negative start parameter, relativeStart is positive"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(-12);
}, {
  expected: "PASSSTRING",
  type: "",
  desc: "negative start parameter, relativeStart is 0"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(4);
}, {
  expected: "STRING",
  type: "",
  desc: "positive start parameter, start is min"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSTRING"]);
  return blobTemp.slice(12);
}, {
  expected: "",
  type: "",
  desc: "positive start parameter, size is min"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(0, -6);
}, {
  expected: "PASS",
  type: "",
  desc: "negative end parameter, relativeEnd is positive"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(0, -12);
}, {
  expected: "",
  type: "",
  desc: "negative end parameter, relativeEnd is 0"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(0, 4);
}, {
  expected: "PASS",
  type: "",
  desc: "positive end parameter, end is min"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(0, 12);
}, {
  expected: "PASSSTRING",
  type: "",
  desc: "positive end parameter, size is min"
});

test_blob(function() {
  var blobTemp = new Blob(["PASSSTRING"]);
  return blobTemp.slice(7, 4);
}, {
  expected: "",
  type: "",
  desc: "span is 0"
});

var invalidTypes = [
  "\xFF",
  "te(xt/plain",
  "te)xt/plain",
  "te<xt/plain",
  "te>xt/plain",
  "te@xt/plain",
  "te,xt/plain",
  "te;xt/plain",
  "te:xt/plain",
  "te\\xt/plain",
  "te\"xt/plain",
  "te/xt/plain",
  "te[xt/plain",
  "te]xt/plain",
  "te?xt/plain",
  "te=xt/plain",
  "te{xt/plain",
  "te}xt/plain",
  "te\x20xt/plain",
  "te\x09xt/plain",
  "te\x00xt/plain",
  "te\x1Fxt/plain",
  "te\x7Fxt/plain"
];
invalidTypes.forEach(function(type) {
  test_blob(function() {
    var blob = new Blob(["PASS"]);
    return blob.slice(0, 4, type);
  }, {
    expected: "PASS",
    type: "",
    desc: "Invalid contentType (" + format_value(type) + ")"
  });
});

var validTypes = [
  "TEXT/PLAIN",
  "text/plain;charset = UTF-8",
  "text/plain;charset=UTF-8"
];
validTypes.forEach(function(type) {
  test_blob(function() {
    var blob = new Blob(["PASS"]);
    return blob.slice(0, 4, type);
  }, {
    expected: "PASS",
    type: type.toLowerCase(),
    desc: "Valid contentType (" + format_value(type) + ")"
  });
});
</script>
